var InfoBubble;(function(n){function y(n){Lib.CssClass.remove(n,"b_hide")}function p(n){Lib.CssClass.add(n,"b_hide")}function w(n){Lib.CssClass.add(n,"infobubble_fadeIn");sj_evt.fire("infobubble_show",n)}function l(n){Lib.CssClass.remove(n,"infobubble_fadeIn")}function b(n){var t=n.getBoundingClientRect();return new et(t.left,t.top,t.bottom-t.top,t.right-t.left)}function k(n){Lib.CssClass.remove(n,"ifbb_tri_bottom");Lib.CssClass.add(n,"ifbb_tri_top")}function d(n){Lib.CssClass.remove(n,"ifbb_tri_top");Lib.CssClass.add(n,"ifbb_tri_bottom")}function st(n){Lib.CssClass.remove(n,"ifbb_tri_right");Lib.CssClass.add(n,"ifbb_tri_left")}function ht(n){Lib.CssClass.remove(n,"ifbb_tri_left");Lib.CssClass.add(n,"ifbb_tri_right")}function ct(n){Lib.CssClass.remove(n,"tri_center");Lib.CssClass.remove(n,"tri_right");Lib.CssClass.add(n,"tri_left")}function g(n){Lib.CssClass.remove(n,"tri_left");Lib.CssClass.remove(n,"tri_right");Lib.CssClass.add(n,"tri_center")}function lt(n){Lib.CssClass.remove(n,"tri_left");Lib.CssClass.remove(n,"tri_center");Lib.CssClass.add(n,"tri_right")}function at(n){Lib.CssClass.remove(n,"tri_middle");Lib.CssClass.remove(n,"tri_bottom");Lib.CssClass.add(n,"tri_top")}function vt(n){Lib.CssClass.remove(n,"tri_top");Lib.CssClass.remove(n,"tri_bottom");Lib.CssClass.add(n,"tri_middle")}function yt(n){Lib.CssClass.remove(n,"tri_top");Lib.CssClass.remove(n,"tri_middle");Lib.CssClass.add(n,"tri_bottom")}function pt(n){Lib.CssClass.remove(n,"ifbb_tri_top");Lib.CssClass.remove(n,"ifbb_tri_bottom");Lib.CssClass.remove(n,"ifbb_tri_left");Lib.CssClass.remove(n,"ifbb_tri_right");Lib.CssClass.remove(n,"tri_left");Lib.CssClass.remove(n,"tri_right");Lib.CssClass.remove(n,"tri_top");Lib.CssClass.remove(n,"tri_bottom");n.style.top="";n.style.right="";n.style.bottom="";n.style.left="";n.style.width=""}function nt(){return _w.innerHeight||_d.documentElement.clientHeight||_d.body.clientHeight}function tt(){return _w.innerWidth||_d.documentElement.clientWidth||_d.body.clientWidth}function e(n){return n+_w.pageYOffset}function wt(n){return _d.body.scrollWidth>tt()&&(n-=ft),n-_w.pageYOffset}function o(n){return n+_w.pageXOffset}function bt(n){return _d.body.scrollHeight>nt()&&(n-=ut),n-_w.pageXOffset}function kt(){var n=sj_ce("div"),i,t,r;return n.style.visibility="hidden",n.style.width="100px",_d.body.appendChild(n),i=n.offsetWidth,n.style.overflow="scroll",t=sj_ce("div"),t.style.width="100%",n.appendChild(t),r=t.offsetWidth,_d.body.removeChild(n),i-r}function dt(){var n=sj_ce("div"),i,t,r;return n.style.visibility="hidden",n.style.height="100px",_d.body.appendChild(n),i=n.offsetHeight,n.style.overflow="scroll",t=sj_ce("div"),t.style.height="100%",n.appendChild(t),r=t.offsetHeight,_d.body.removeChild(n),i-r}function gt(n,t,i,r,u,f,e){if(!h[n]){var o=new ot(n,t,i,r,u,f,e);h[n]=o}}function ni(n,t,r,u,f,e,o,s,h,c,l,a,y,p,w){var b=function(n,t,r,u,f,e,o,s,h,c,l,a,y,p,w){if(!i[n]){var b=new v(n,t,r,u,f,e,o,s,h,c,l,a,y,p,w);i[n]=b}},k=[n,t,r,u,f,e,o,s,h,c,l,a,y,p,w],d=_ge(n);typeof SmartRendering!="undefined"?SmartRendering.LoadElementWhenDisplayed(this,d,b,k):b.apply(this,k)}function ti(n,t){t===void 0&&(t=!0);i[n]&&i[n].setFocus(t)}function it(n){return i[n]&&i[n].getStatus()===t.Shown}function ii(n,t){if(t===void 0&&(t=!0),it(n))return i[n].hide(!0,t),!0;return!1}var u=8,f=16,rt=1,c=20,a=50,s=14,ut=kt(),ft=dt(),h=[],i=[],et=function(){function n(n,t,i,r){this.left=n;this.top=t;this.height=i;this.width=r}return n}(),ot=function(){function n(n,t,i,r,u,f,e){(this.id=n,this.bubbleId=t,this.node=_ge(n),this.anchor=_ge(i),this.node&&_ge(this.bubbleId))&&(this.anchor==null&&(this.anchor=this.node),this.init(r,u,f,e))}return n.prototype.getAnchorLocation=function(){return b(this.anchor)},n.prototype.hideBubbles=function(){for(var n in i)i.hasOwnProperty(n)&&i[n].hide(!0)},n.prototype.init=function(n,t,r,u){var f=this;n&&sj_be(this.node,"click",function(){i[f.bubbleId].show(!1);sj_pd(event);sj_sp(event)});t&&(sj_be(this.node,"mouseenter",function(){i[f.bubbleId].show(!0)}),sj_be(this.node,"keyup",function(n){n.keyCode==9&&i[f.bubbleId].show(!1)}));r&&(sj_be(this.node,"click",function(n){for(var t in i)i.hasOwnProperty(t)&&t!=f.bubbleId&&i[t].hide(!0);sj_sp(n)}),sj_evt.bind("slideexp_movestart",this.hideBubbles));u&&sj_be(this.node,"mouseleave",function(){i[f.bubbleId].hide()});u&&(sj_be(this.node,"keydown",function(n){n.keyCode==27&&i[f.bubbleId].hide()}),sj_be(this.node,"focusout",function(n){var u=sj_ev(n),t=u.relatedTarget,r=_ge(f.bubbleId);t!==null&&(f.node.contains(t)||r==null||r.contains(t))||i[f.bubbleId].hide()}))},n}(),t,r,v;(function(n){n[n.Hidden=0]="Hidden";n[n.Showing=1]="Showing";n[n.Shown=2]="Shown";n[n.Hiding=3]="Hiding"})(t||(t={})),function(n){n[n.Top=0]="Top";n[n.Right=1]="Right";n[n.Bottom=2]="Bottom";n[n.Left=3]="Left"}(r||(r={}));v=function(){function n(n,i,u,f,e,o,s,h,c,l,a,v,y,p,w){var b,k;(this.triangleHorizontalPlacingOrder=[0,-1,1],this.triangleVerticalPlacingOrder=[0,-1,1],this.state=t.Hidden,this.timerId=-1,this.actualWidth=0,this.actualHeight=0,this.hideOnlyByClick=!1,this.id=n,this.itemId=i,this.locatorId=u,this.width=f,this.padding=e,this.anchorVerticalOffsetPixel=o,this.extraWidth=e+rt,this.enableOverlay=h,this.enableFullWidth=c,this.enableUnfixedTriangle=l,this.enableBubbleHeader=a,this.enableClickOutsideToClose=v,this.enableHoverOutsideToClose=y,this.enableDynamicWidth=p,this.disableInitialFocus=w,this.node=_ge(n),this.node)&&(b=a?1:0,this.beforeNode=this.node.children[b],this.closeNode=this.node.children[b+1],this.content=this.node.children[b+2],this.afterNode=this.node.children[b+3],this.locatorNode=_ge(this.locatorId),this.locatorNode&&this.locatorNode.appendChild(this.node),this.appns=this.node.getAttribute("data-appns"),this.k=this.node.getAttribute("data-k"),this.infoBubblePosition=this.getPosition(this.node.getAttribute("data-ibp")),k=this.getPosition(this.node.getAttribute("data-trp")),this.infoBubblePosition==r.Left||this.infoBubblePosition==r.Right?k==r.Top?this.triangleVerticalPlacingOrder=[1,0,-1]:k==r.Bottom&&(this.triangleVerticalPlacingOrder=[-1,0,1]):k==r.Left?this.triangleHorizontalPlacingOrder=[-1,0,1]:k==r.Right&&(this.triangleHorizontalPlacingOrder=[1,0,-1]),this.init(s))}return n.prototype.getPosition=function(n){return n==="top"?r.Top:n==="right"?r.Right:n==="bottom"?r.Bottom:n==="left"?r.Left:void 0},n.prototype.getStatus=function(){return this.state},n.prototype.show=function(n){switch(this.state){case t.Hidden:this.state=t.Showing;this.showBubble(n);break;case t.Hiding:sb_ct(this.timerId);w(this.node);this.state=t.Shown}},n.prototype.hide=function(n,i){var r=this;if(n===void 0&&(n=!1),i===void 0&&(i=!1),!this.hideOnlyByClick||n)switch(this.state){case t.Showing:this.state=t.Hidden;l(this.node);break;case t.Shown:this.state=t.Hiding;n?this.hideBubble(i):this.timerId=sb_st(function(){l(r.node);r.timerId=sb_st(function(){r.hideBubble(i)},a)},a);break;case t.Hiding:n&&(sb_ct(this.timerId),this.hideBubble(i))}},n.prototype.setFocus=function(n){var r=this,t,i;n===void 0&&(n=!0);n&&AccessibilityHelpers.focusFirstFocusableElementWithin(this.node);t=AccessibilityHelpers.getFocusableElementWithin(this.node);i=AccessibilityHelpers.getFocusableElementWithin(this.node,!0);t!=null&&this.firstChildNode==null&&sj_be(this.node,"focusin",function(n){r.show(!1);sj_sp(n)});t!=null&&t!=this.firstChildNode&&(this.firstChildNode=t,sj_be(this.firstChildNode,"focusout",function(n){r.hide();sj_sp(n)}));i!=null&&i!=t&&i!=this.lastChildNode&&(this.lastChildNode=i,sj_be(this.lastChildNode,"focusout",function(n){r.hide();sj_sp(n)}))},n.prototype.init=function(n){var t=this;this.enableFullWidth&&Lib.CssClass.add(this.node,"fullwidth");this.enableOverlay&&(this.overlayNode=sj_ce("div",null,"infobubble_overlay"),sj_be(this.overlayNode,"click",function(){t.hide(!0)}));sj_be(this.closeNode,"click",function(){t.hide(!0,!0)});sj_be(this.closeNode,"keydown",function(n){(n.keyCode===13||n.keyCode===32)&&(sj_pd(n),t.hide(!0,!0))});this.enableOverlay||(sj_be(this.node,"mouseenter",function(){t.show(!0)}),this.enableClickOutsideToClose&&(sj_be(this.node,"click",function(n){sj_sp(n)}),sj_be(_d.body,"click",function(){t.hide(!0);sj_evt.fire("bubble_clickOutsideToClose",t.id)})),this.enableHoverOutsideToClose&&sj_be(this.node,"mouseleave",function(){var n=!Lib.CssClass.contains(t.closeNode,"b_hide");n?t.hide():t.hide(!0)}));n&&sj_evt.bind("onP1",function(){t.hideOnlyByClick=!0;t.show(!1)},!0);Orientation.onOrientation(function(n){t.onOrientation(n)})},n.prototype.getBubbleHeight=function(n){var t=this.node,i,r;return t.style.visibility="hidden",t.style.top="-5000px",t.style.width=n+"px",i=!Lib.CssClass.contains(t,"b_hide"),y(t),_d.body.appendChild(t),r=t.offsetHeight,_d.body.removeChild(t),i||p(t),t.style.width="",t.style.top="",t.style.visibility="",r},n.prototype.showBubble=function(n){var i=this,r;if(this.state==t.Showing){if(r=this.placeAround(h[this.itemId].getAnchorLocation()),!r){this.state=t.Hidden;return}this.enableOverlay&&_d.body.appendChild(this.overlayNode);this.locatorNode||_d.body.appendChild(this.node);y(this.node);sb_st(function(){w(i.node)},20);this.state=t.Shown;n&&this.disableInitialFocus||sb_st(function(){i.setFocus()},20);Log.Log("Show","InfoBubble",this.id,!1,"AppNS",this.appns,"K",this.k)}},n.prototype.hideBubble=function(n){if(n===void 0&&(n=!0),this.state==t.Hiding){l(this.node);p(this.node);this.locatorNode||this.node&&this.node.parentNode&&this.node.parentNode.removeChild(this.node);this.enableOverlay&&this.overlayNode&&this.overlayNode.parentNode&&this.overlayNode.parentNode.removeChild(this.overlayNode);this.resetBubble();this.state=t.Hidden;var i=_ge(this.itemId);i&&n&&AccessibilityHelpers.focusFirstFocusableElementWithin(i);Log.Log("Hide","InfoBubble",this.id,!1,"AppNS",this.appns,"K",this.k)}},n.prototype.resetBubble=function(){pt(this.node);this.beforeNode.style.left="";this.afterNode.style.left="";this.beforeNode.style.top="";this.afterNode.style.top=""},n.prototype.onOrientation=function(){this.state==t.Shown&&(this.resetBubble(),this.placeAround(h[this.itemId].getAnchorLocation()))},n.prototype.placeAround=function(n){if(this.locatorNode)return this.placeIn(this.locatorNode,n);var t=tt(),i=nt();if(this.actualWidth=this.getActualWidth(t),this.actualHeight=this.getBubbleHeight(this.actualWidth),this.enableBubbleHeader&&!this.enableFullWidth)return this.placeAroundWithHeader(n,t);if(this.infoBubblePosition==r.Left||this.infoBubblePosition==r.Right)if(this.placeInfoBubbleHorizontal(n.left,n.width,t))this.placeTriangleVertical(n.top,n.height,i);else return!1;else this.placeInfoBubbleVertical(n.top,n.height,i),this.placeTriangleHorizontal(n.left,n.width,t);return!0},n.prototype.placeAroundWithHeader=function(n,t){var r=e(Math.max(0,n.top-(this.actualHeight-n.height)/2)),i=o(n.left+n.width+u);return i+this.actualWidth<t?(this.node.style.top=r+"px",this.node.style.left=i+"px",this.node.style.width=this.actualWidth+"px",Lib.CssClass.add(this.node,"chevron_left"),!0):!1},n.prototype.placeIn=function(n,t){var r=b(n),i;return r.top>=t.top+t.height?(k(this.node),r.top-u<t.top+t.height&&(this.node.style.top=u+"px")):(d(this.node),this.node.style.bottom=r.top+r.height+u>t.top?u+"px":"0"),i=t.width/2-f/2,i+=t.left-r.left,i<0?i=0:i>r.width-f&&(i=r.width-f),this.beforeNode.style.left=i+"px",this.afterNode.style.left=i+"px",!0},n.prototype.getActualWidth=function(n){return this.enableFullWidth?n-2*this.extraWidth-2*c:(this.width+2*this.extraWidth)*1.5>n?n/1.5-2*this.extraWidth:this.width},n.prototype.placeInfoBubbleVertical=function(n,t,i){var f=this.anchorVerticalOffsetPixel>t?t:this.anchorVerticalOffsetPixel,e=i-(n+t)+f,o=n+f;if(this.infoBubblePosition==r.Top){this.actualHeight+2*this.extraWidth+u<o||o>e?this.placeTopInfoBubble(n,f):this.placeBottomInfoBubble(n,t,f);return}this.actualHeight+2*this.extraWidth+u<e||e>o?this.placeBottomInfoBubble(n,t,f):this.placeTopInfoBubble(n,f)},n.prototype.placeInfoBubbleHorizontal=function(n,t,i){var f=this.anchorVerticalOffsetPixel>t?t:this.anchorVerticalOffsetPixel,o=i-(n+t)+f,e=n+f;return this.infoBubblePosition==r.Left&&this.width+2*this.extraWidth+u<e?(this.placeLeftInfoBubble(n,f),!0):this.width+2*this.extraWidth+u<o?(this.placeRightInfoBubble(n,t,f),!0):this.width+2*this.extraWidth+u<e?(this.placeLeftInfoBubble(n,f),!0):!1},n.prototype.placeBottomInfoBubble=function(n,t,i){k(this.node);this.node.style.top=e(n+t+u-i)+"px"},n.prototype.placeTopInfoBubble=function(n,t){d(this.node);var i=this.getBubbleHeight(this.actualWidth);this.node.style.top=e(n-i-u+t)+"px"},n.prototype.placeRightInfoBubble=function(n,t,i){st(this.node);this.node.style.left=o(n+t+u-i)+"px"},n.prototype.placeLeftInfoBubble=function(n,t){ht(this.node);var i=this.width+2*this.extraWidth;this.node.style.left=o(n-i-u+t)+"px"},n.prototype.placeTriangleHorizontal=function(n,t,i){var r,u,f,o,e;if(this.node.style.width=this.enableDynamicWidth?"":this.actualWidth+"px",this.enableFullWidth&&this.enableBubbleHeader){g(this.node);return}if(this.enableUnfixedTriangle){this.placeUnfixedTriangle(n,t,i);return}for(r=n+t/2,u=this.actualWidth/2+this.extraWidth,f=0,o=this.triangleHorizontalPlacingOrder;f<o.length;f++){if(e=o[f],e==0&&r-u>=0&&r+u<=i){this.placeCenterBubble(n,t,i);return}if(e<0&&n>=u){this.placeLeftBubble(n,t,i);return}if(e>0&&n+t+u<=i){this.placeRightBubble(n,t,i);return}}if(r<i/3){this.placeRightBubble(n,t,i);return}if(r>i/3*2){this.placeLeftBubble(n,t,i);return}this.placeCenterBubble(n,t,i);return},n.prototype.placeTriangleVertical=function(n,t,i){var r,u,f,o,e;if(this.node.style.width=this.enableDynamicWidth?"":this.width+"px",this.enableUnfixedTriangle){this.placeUnfixedTriangle(n,t,i);return}for(r=n+t/2,u=this.actualHeight/2,f=0,o=this.triangleVerticalPlacingOrder;f<o.length;f++){if(e=o[f],e==0&&r-u>=0&&r+u<=i){this.placeMiddleBubble(n,t,i);return}if(e<0&&n>=u){this.placeTopBubble(n,t,i);return}if(e>0&&n+t+u<=i){this.placeBottomBubble(n,t,i);return}}if(r<i/3){this.placeBottomBubble(n,t,i);return}if(r>i/3*2){this.placeTopBubble(n,t,i);return}this.placeMiddleBubble(n,t,i);return},n.prototype.placeUnfixedTriangle=function(n,t,i){var u=n+t/2-c,r=u-f/2;r=Math.max(r,this.padding);r=Math.min(r,i-2*c-this.padding-f);this.beforeNode.style.left=r+"px";this.afterNode.style.left=r+"px"},n.prototype.placeRightBubble=function(n,t){ct(this.node);var i=n+t/2,r=f/2+s;this.node.style.left=o(i-r)+"px"},n.prototype.placeCenterBubble=function(n,t){g(this.node);var i=n+t/2,r=(this.actualWidth+2*this.extraWidth)/2;this.node.style.left=o(i-r)+"px"},n.prototype.placeLeftBubble=function(n,t,i){lt(this.node);var r=i-(n+t/2),u=f/2+s;this.node.style.right=bt(r-u)+"px"},n.prototype.placeBottomBubble=function(n,t){at(this.node);var i=n+t/2,r=f/2+s;this.node.style.top=e(i-r)+"px"},n.prototype.placeMiddleBubble=function(n,t){vt(this.node);var i=n+t/2,r=this.actualHeight/2;this.node.style.top=e(i-r)+"px"},n.prototype.placeTopBubble=function(n,t,i){yt(this.node);var r=i-(n+t/2),u=f/2+s;this.node.style.bottom=wt(r-u)+"px"},n}();n.initItem=gt;n.initBubble=ni;n.setBubbleFocus=ti;n.isBubbleShowing=it;n.closeBubble=ii;sj_evt.fire("infobubble_initBubble",n);sj_evt.fire("infobubble_initItem",n)})(InfoBubble||(InfoBubble={}))